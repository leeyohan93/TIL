# Spring AOP

## 1. Spring AOP 란? 
애플리케이션의 핵심적인 기능에서 부가적인 기능을 분리해내어 애스팩트라는 모듈로 만들어 설계하고 개발하는 방법
- 애스팩트: 인프라 혹은 부가기능의 모듈
- OOP: 비즈니스 로직의 모듈화
- AOP: 인프라 혹은 부가기능의 모듈화 (로깅, 트랜잭션, 보안 등 부가 기능)

## 2. AOP의 장점
- 핵심은 공통된 기능을 재사용하는 기법이라는 것
- 어플리케이션 전체에 흩어진 공통 기능을 하나의 장소에서 관리
- 핵심 기능을 하는 모듈들이 본인의 목적에만 충실하고 그외 사항들은 신경쓰지 않아도 된다는 점

## 3. 실행되는 과정
- 클라이언트에서 타겟을 호출하게 되면 타겟이 아닌 타겟을 감싸고 있는 프록시가 호출되어, 타겟 메소드 실행전에 선처리, 타겟 메소드 실행 후, 후처리를 실행시키도록 구성되어있습니다.

## 4. AOP 용어
- **타겟**: 부가기능을 부여할 대상
- **애스펙트**: 부가기능 모듈, 핵심기능에 부가되어 의미를 갖는 특별한 모듈
어드바이스, 포인트 컷을 갖고 있다
- **어드바이스**: 실직적으로 부가기능을 담은 구현체
- **포인트컷**: 부가기능이 적용될 대상(메소드)를 선정하는 방법
어드바이스를 적용할 조인포인트를 선별하는 기능을 정의한 모듈을 애기
- **조인포인트**: 어드바이스가 적용될 수 있는 위치
- **프록시**: 타겟을 감싸서 타겟의 요청을 대신 받아주는 랩핑(Wrapping) 오브젝트입니다.
클라이언트에서 타겟을 호출하게 되면 타겟이 아닌 타겟을 감싸고 있는 프록시가 호출되어, 타겟 메소드 실행전에 선처리, 타겟 메소드 실행 후, 후처리를 실행시키도록 구성되어있습니다.
- **인트로덕션:** 타겟 클래스에 코드 변경없이 신규 메소드나 멤버변수를 추가하는 기능
- **위빙:** 지정된 객체에 애스팩트를 적용해서 새로운 프록시 객체를 생성하는 과정

## 5. 스프링 AOP 구현 방법
- Spring AOP는 Proxy를 기반으로 한 **Runtime Weaving** 방식이다
- Spring AOP에서는 JDK Dynamic Proxy 와 CGlib 을 통해 Proxy화 한다

### 5-1. 다이내믹 프록시
- Interface를 기반으로 Proxy를 생성해주는 방식
- 특정 Object에 대해 Reflection을 사용하기 때문에 성능이 조금 떨어지는 크리티컬한 단점 (InvocationHandler 구현)

### 5-2. CGLIB
- 상속 방식을 이용해서 Proxy화 할 메서드를 오버라이딩 하는 방식 (의존성 주입X)
(MethodInterceptor 구현)
- 프록시 방식보다 훨씬 강력하고 유연한 AOP가 가능하다. 
바이트코드를 직접 조작해서 AOP를 적용하면 오브젝트의 생성, 필드 값이 조회와 조작, 스태틱 초기화 등의 다양한 작업에 부가기능을 부여해줄 수 있다.
- 다만, final 객체 혹은 private 접근자로 된 메서드는 상속(Override)가 지원되지 않기 때문에 제약적인 Proxy 구현이 가능
